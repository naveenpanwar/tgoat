<!DOCTYPE html>
<html lang="en">
	<head>
		<meta charset='utf-8'>
		<meta http-equiv="X-UA-Compatible" content="IE-edge">
		<meta name="viewport" content="width=device-width, initial-scale=1">
		<title>
			To-Do lists
		</title>
		<link href="/static/bootstrap/css/bootstrap.min.css" rel="stylesheet">
		<link href="/static/css/base.css" rel="stylesheet">
	</head>
	<body>
		<div class="container">
			<nav class='navbar navbar-default' role='navigation'>
				<a class="navbar-brand" href="/">Superlists</a>
				<a class="btn navbar-btn navbar-right" id="id_login" href="#">Sign In</a>
			</nav>

			<div class="row">
				<div class="col-md-6 col-md-offset-3 jumbotron">
					<div class="text-center">
						<h1>{% block header_text %}{% endblock %}</h1>
						<form method="POST" action="{% block form_action %}{% endblock %}">
							{% csrf_token %}
							{% if form.errors %}
								<div class="form-group has-error">
									<span class="help-block">{{ form.text.errors }}</span>
								</div>
							{% endif %}
							{{ form.text }}
						</form>
					</div>
				</div>
			</div>
			<div class="row">
				<div class="col-md-6 col-md-offset-3">
					{% block table %}
					{% endblock %}
				</div>
			</div>
		</div>
		<script src="https://code.jquery.com/jquery-3.1.0.min.js"></script>
		<script src="https://login.persona.org/include.js"></script>
		<script src="/static/accounts/js/accounts.js"></script>
		<script src="/static/lists/js/list.js"></script>
		<script>
			$(document).ready( function() {
				/*
				var currentUser = '{{ user.email}}' || null;
				var csrf_token = '{{ csrf_token }}';
				console.log(currentUser);

				navigator.id.watch({
				  loggedInUser: currentUser,
				  onlogin: function(assertion) {
					// A user has logged in! Here you need to:
					// 1. Send the assertion to your backend for verification and to create a session.
					// 2. Update your UI.
					$.ajax({ /* <-- This example uses jQuery, but you can use whatever you'd like *//*
					  type: 'POST',
					  url: '/accounts/login', // This is a URL on your website.
					  data: {assertion: assertion, csrfmiddlewaretoken: csrf_token},
					  success: function(res, status, xhr) { window.location.reload(); },
					  error: function(xhr, status, err) {
						navigator.id.logout();
						console.log("Login failure: " + err);
					  }
					});
				  },
				  onlogout: function() {
					// A user has logged out! Here you need to:
					// Tear down the user's session by redirecting the user or making a call to your backend.
					// Also, make sure loggedInUser will get set to null on the next page load.
					// (That's a literal JavaScript null. Not false, 0, or undefined. null.)
					$.ajax({
					  type: 'POST',
					  url: '/accounts/logout', // This is a URL on your website.
					  success: function(res, status, xhr) { window.location.reload(); },
					  error: function(xhr, status, err) { console.log("Logout failure: " + err); }
					});
				  }
				});

				var urls = {
					login: "{% url 'accounts:login' %}",
					logout: "{% url 'accounts:logout' %}",
				}
				*/

				Superlists.Accounts.initialize(navigator);
			});
		</script>
	</body>
</html>
